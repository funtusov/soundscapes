<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>EtherPad Soundscape</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>

    <!-- Start Overlay -->
    <div id="overlay">
        <h1 class="text-3xl mb-2 font-light tracking-widest text-white">ETHERPAD</h1>
        <p class="mb-8 text-gray-400 text-sm">Headphones Recommended</p>
        <button id="startBtn" class="btn">Initialize System</button>
    </div>

    <!-- HUD -->
    <div class="hud hud-tl" id="voiceList">
        <div class="voice-placeholder">--</div>
    </div>
    <div class="hud hud-tr">
        LPF: <span id="val-tilt">--</span><br>
        Motion: <span id="val-motion">--</span>
    </div>

    <canvas id="canvas"></canvas>

    <!-- Scale Controls -->
    <div class="scale-controls" id="scaleControls" style="display: none;">
        <!-- Range: collapsible control with octaves + location -->
        <div class="range-control" id="rangeControl">
            <button class="range-summary" id="rangeSummary">3 Mid</button>
            <div class="range-options" id="rangeOptions">
                <div class="range-row">
                    <span class="range-label">Oct</span>
                    <button class="range-oct-btn" data-oct="1">1</button>
                    <button class="range-oct-btn" data-oct="2">2</button>
                    <button class="range-oct-btn active" data-oct="3">3</button>
                    <button class="range-oct-btn" data-oct="5">5</button>
                </div>
                <div class="range-row">
                    <span class="range-label">Loc</span>
                    <button class="range-loc-btn" data-loc="bass">Bass</button>
                    <button class="range-loc-btn active" data-loc="mid">Mid</button>
                    <button class="range-loc-btn" data-loc="high">High</button>
                </div>
            </div>
        </div>

        <!-- Quantize: collapsed summary or expanded options -->
        <div class="quantize-control" id="quantizeControl">
            <button class="quantize-summary" id="quantizeSummary">Free</button>
            <div class="quantize-options" id="quantizeOptions">
                <button class="quantize-off-btn" id="quantizeOffBtn">Off</button>
                <select id="tonicSelect" class="scale-select">
                    <option value="0">C</option>
                    <option value="1">C#</option>
                    <option value="2">D</option>
                    <option value="3">D#</option>
                    <option value="4">E</option>
                    <option value="5">F</option>
                    <option value="6">F#</option>
                    <option value="7" selected>G</option>
                    <option value="8">G#</option>
                    <option value="9">A</option>
                    <option value="10">A#</option>
                    <option value="11">B</option>
                </select>
                <select id="scaleSelect" class="scale-select">
                    <option value="major">Major</option>
                    <option value="minor">Minor</option>
                    <option value="pent_maj">Pent Maj</option>
                    <option value="pent_min" selected>Pent Min</option>
                    <option value="blues">Blues</option>
                    <option value="dorian">Dorian</option>
                    <option value="lydian">Lydian</option>
                    <option value="mixolydian">Mixo</option>
                    <option value="harm_min">Harm Min</option>
                    <option value="whole_tone">Whole</option>
                    <option value="chromatic">Chromatic</option>
                </select>
            </div>
        </div>

        <button class="envelope-btn" id="envelopeBtn">Pad</button>
        <button class="arp-btn" id="arpBtn">Arp</button>
    </div>

    <!-- Loop Controls -->
    <div class="loop-controls" id="loopControls" style="display: none;">
        <button class="loop-btn" id="loopRecordBtn" title="Record">
            <span class="loop-icon">●</span>
        </button>
        <button class="loop-btn" id="loopPlayBtn" title="Play" disabled>
            <span class="loop-icon">▶</span>
        </button>
        <button class="loop-btn" id="loopClearBtn" title="Clear" disabled>
            <span class="loop-icon">✕</span>
        </button>
        <span class="loop-status" id="loopStatus">--</span>
    </div>

    <!-- Beats Controls (for Beats mode) -->
    <div class="beats-controls" id="beatsControls" style="display: none;">
        <button class="beats-play-btn" id="beatsPlayBtn">▶</button>
        <div class="tempo-control">
            <span class="tempo-label">BPM</span>
            <input type="range" id="tempoSlider" min="40" max="200" value="105" class="tempo-slider">
            <span class="tempo-value" id="tempoValue">105</span>
        </div>
        <div class="volume-control">
            <span class="volume-label">Vol</span>
            <input type="range" id="beatsVolumeSlider" min="0" max="100" value="70" class="volume-slider">
        </div>
    </div>

    <!-- Main bottom bar -->
    <div class="mode-selector" id="modeSelector" style="display: none;">
        <!-- Reverb: collapsible control -->
        <div class="reverb-control" id="reverbControl">
            <button class="reverb-summary" id="reverbSummary">Reverb</button>
            <div class="reverb-options" id="reverbOptions">
                <button class="reverb-off-btn" id="reverbOffBtn">Off</button>
                <div class="reverb-sliders">
                    <div class="reverb-slider-row">
                        <span class="reverb-slider-label">Size</span>
                        <input type="range" id="reverbSizeSlider" min="0" max="100" value="60" class="reverb-slider">
                    </div>
                    <div class="reverb-slider-row">
                        <span class="reverb-slider-label">Mix</span>
                        <input type="range" id="reverbMixSlider" min="0" max="100" value="50" class="reverb-slider">
                    </div>
                </div>
            </div>
        </div>

        <button class="compass-pan-btn" id="compassPanBtn" title="Compass Pan">Pan</button>

        <!-- Noise: collapsible control -->
        <div class="noise-control" id="noiseControl">
            <button class="noise-summary" id="noiseSummary">Ambience</button>
            <div class="noise-options" id="noiseOptions">
                <button class="noise-type-btn" data-type="off">Off</button>
                <button class="noise-type-btn" data-type="waves">Waves</button>
                <button class="noise-type-btn" data-type="rain">Rain</button>
                <button class="noise-type-btn" data-type="wind">Wind</button>
                <button class="noise-type-btn" data-type="fire">Fire</button>
                <div class="noise-volume">
                    <input type="range" id="textureVolumeSlider" min="0" max="100" value="20" class="noise-slider">
                </div>
            </div>
        </div>

        <div class="volume-control">
            <span class="volume-label">Vol</span>
            <input type="range" id="volumeSlider" min="0" max="100" value="100" class="volume-slider">
        </div>

        <button class="loop-toggle-btn" id="loopToggleBtn" title="Loop">⟳</button>

        <button class="record-btn" id="recordBtn" title="Record">
            <span class="record-icon">●</span>
            <span class="record-time" id="recordTime"></span>
        </button>
    </div>

    <!-- Effects Controls (hidden, functionality moved to main bar) -->
    <div class="effects-controls" id="effectsControls" style="display: none;"></div>

    <script type="module" src="/src/main.ts"></script>
</body>
</html>
